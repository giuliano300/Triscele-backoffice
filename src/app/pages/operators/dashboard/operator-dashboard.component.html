<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item active" aria-current="page">Presenza di oggi</li>
  </ol>
</nav>

<div class="dashboard-grid">

  <!-- ===== PRIMA DELL'ENTRATA ===== -->
  <mat-card class="card-entry" *ngIf="!attendance" @fadeIn>
    <h2>Conferma Presenza</h2>
    <div class="card-body">
      <p><i-feather name="Clock"></i-feather> Orario: {{ entryTime }}</p>
      <textarea [(ngModel)]="notes" placeholder="Note"></textarea>
      <button mat-raised-button color="primary" (click)="confirmEntry()">
        <i-feather name="LogIn"></i-feather> Conferma Entrata
      </button>
    </div>
  </mat-card>

  <!-- ===== GIORNATA ATTIVA ===== -->
  <ng-container *ngIf="attendance && !attendance.exitTime">
    <mat-card class="card-timer" @fadeIn>
      <h2>Tempo Lavorato</h2>
      <h1>{{ liveTimer }}</h1>
    </mat-card>

    <mat-card class="card-break" *ngIf="!hasActiveBreak()" @fadeIn>
      <button mat-raised-button color="accent" (click)="startBreak()">
        <i-feather name="Coffee"></i-feather> Inizia Pausa
      </button>
    </mat-card>

    <mat-card class="card-break" *ngIf="hasActiveBreak()" @fadeIn>
      <h3>Pausa in corso</h3>
      <h1>{{ breakTimer }}</h1>
      <button mat-raised-button color="primary" (click)="endBreak()">
        <i-feather name="Coffee"></i-feather> Termina Pausa
      </button>
    </mat-card>

    <mat-card class="card-exit" @fadeIn>
      <button mat-raised-button color="warn" (click)="confirmExit()">
        <i-feather name="LogOut"></i-feather> Chiudi Giornata
      </button>
    </mat-card>
  </ng-container>

  <!-- ===== RIEPILOGO ===== -->
  <mat-card class="card-summary" *ngIf="attendance?.exitTime" @fadeIn>
    <h2>Riepilogo Giornata</h2>
    <p><strong>Entrata:</strong> {{ attendance?.entryTime }}</p>
    <p *ngFor="let b of attendance?.breaks">
      <strong>Pausa:</strong> {{ b.start }} - {{ b.end || 'In corso' }}
    </p>
    <p><strong>Uscita:</strong> {{ attendance?.exitTime }}</p>
    <p><strong>Totale lavorato:</strong> {{ liveTimer }}</p>
  </mat-card>

</div>
