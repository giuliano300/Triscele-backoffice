<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li aria-current="page" class="breadcrumb-item active">{{title}}</li>
  </ol>
</nav>

<mat-card class="trinta-card mb-10 bg-white border-none d-block">
  <mat-card-content>
    <form [formGroup]="disciplinaryForm" (ngSubmit)="onSubmit()">
        <mat-stepper #stepper>
            <mat-step>
              <ng-template matStepLabel>
                  Dati personali
                </ng-template>
                <div class="row g-3 mt-20" [formGroupName]="'personalData'"> 
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Settore</label>
                    <mat-form-field class="w-100">
                      <i-feather name="credit-card"></i-feather>
                      <mat-label>Settore</mat-label>
                      <mat-select formControlName="sectorId">
                        <mat-option *ngFor="let o of sectors" [value]="o._id">
                          {{ o.name }}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10"> Ragione sociale </label>
                    <mat-form-field class="w-100">
                      <i-feather name="briefcase"></i-feather>
                      <mat-label>Ragione sociale</mat-label>
                      <input matInput formControlName="businessName" type="text">
                    </mat-form-field>
                  </div>

                  <!-- Partita IVA -->
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Codice fiscale</label>
                    <mat-form-field class="w-100">
                      <i-feather name="file-text"></i-feather>
                      <mat-label>Codice fiscale</mat-label>
                      <input matInput formControlName="fiscalCode" type="text">
                      <mat-error *ngIf="disciplinaryForm.get('fiscalCode')?.hasError('required')">
                        Il Codice fiscale Ã¨ obbligatorio
                      </mat-error>
                      <mat-error *ngIf="disciplinaryForm.get('fiscalCode')?.hasError('fiscalCode')">
                        {{ disciplinaryForm.get('fiscalCode')?.getError('fiscalCode') }}
                      </mat-error>
                    </mat-form-field>
                  </div>

                  <!-- Nome e Cognome -->
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Nome</label>
                    <mat-form-field class="w-100">
                      <i-feather name="user"></i-feather>
                      <mat-label>Nome</mat-label>
                      <input matInput formControlName="name" type="text">
                    </mat-form-field>
                  </div>

                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Cognome</label>
                    <mat-form-field class="w-100">
                      <i-feather name="user-check"></i-feather>
                      <mat-label>Cognome</mat-label>
                      <input matInput formControlName="lastName" type="text">
                    </mat-form-field>
                  </div>


                  <!-- Data di nascita  -->
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Data di nascita</label>
                    <mat-form-field class="w-100">
                      <i-feather name="calendar"></i-feather>
                      <mat-label>Data di nascita</mat-label>
                      <input matInput [matDatepicker]="picker" formControlName="birthDate">
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>          
                    </mat-form-field>
                  </div>
          
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Telefono</label>
                    <mat-form-field class="w-100">
                      <i-feather name="phone"></i-feather>
                      <mat-label>Telefono</mat-label>
                      <input matInput formControlName="mobile" type="text">
                    </mat-form-field>
                  </div>

                  <div class="col-sm-6 mb-10">
                    <label class="label d-block fw-medium mb-10">Status</label>
                    <mat-form-field class="w-100">
                      <i-feather name="activity"></i-feather>
                      <mat-label>Status</mat-label>
                      <mat-select formControlName="status">
                        <mat-option [value]="1">Attivo</mat-option>
                        <mat-option [value]="2">Disattivo</mat-option>
                        <mat-option [value]="3">Cancellato</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                <div class="row g-3"> 
                    <div class="col-sm-6 mt-10 text-start">
                        <button mat-flat-button onclick="returnBack()" class="mr-15 back">Indietro</button>
                    </div>
                    <div class="col-sm-6 mt-10 text-end">
                      <button type="button" mat-flat-button matStepperNext color="primary" [disabled]="disciplinaryForm.get('personalData')?.invalid">Avanti</button>
                    </div>
                </div>
              </div>
            </mat-step>
            <mat-step>
              <ng-template matStepLabel>
                    Accessi
                </ng-template>
                <div class="row g-3 mt-20" [formGroupName]="'accessData'"> 
                  <!-- Email -->
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Email</label>
                    <mat-form-field class="w-100">
                      <i-feather name="mail"></i-feather>
                      <mat-label>Email</mat-label>
                      <input matInput formControlName="email" type="email">
                    </mat-form-field>
                  </div>

                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Password</label>
                    <mat-form-field class="w-100">
                      <i-feather name="lock"></i-feather>
                      <mat-label>Pwd</mat-label>
                      <input matInput formControlName="pwd" type="password">
                    </mat-form-field>
                  </div>
                </div>
                <div class="row g-3"> 
                    <div class="col-sm-6 mt-10 text-start">
                      <button mat-flat-button matStepperPrevious class="mr-15 back">Indietro</button>
                    </div>
                    <div class="col-sm-6 mt-10 text-end">
                      <button type="button" mat-flat-button matStepperNext color="primary" [disabled]="disciplinaryForm.get('accessData')?.invalid">Avanti</button>
                    </div>
                </div>
            </mat-step>
            <mat-step>
              <ng-template matStepLabel>
                    Indirizzo
                </ng-template>
                <div class="row g-3 mt-20" [formGroupName]="'addressData'"> 
                  <!-- Indirizzo e CAP -->
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Indirizzo</label>
                    <mat-form-field class="w-100">
                      <i-feather name="map-pin"></i-feather>
                      <mat-label>Indirizzo</mat-label>
                      <input matInput formControlName="address" type="text">
                    </mat-form-field>
                  </div>

                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">CAP</label>
                    <mat-form-field class="w-100">
                      <i-feather name="map-pin"></i-feather>
                      <mat-label>CAP</mat-label>
                      <input matInput formControlName="zipCode" type="text">
                    </mat-form-field>
                  </div>

                  <!-- Provincia e Comune -->
                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Provincia</label>
                    <mat-form-field class="w-100">
                      <i-feather name="map"></i-feather>
                      <mat-label>Provincia</mat-label>
                      <mat-select formControlName="province" placeholder="Seleziona provincia">
                        <mat-option *ngFor="let p of province" [value]="p">{{p}}</mat-option>
                      </mat-select>          
                    </mat-form-field>
                  </div>

                  <div class="col-sm-6">
                    <label class="label d-block fw-medium mb-10">Comune</label>
                    <mat-form-field class="w-100">
                      <i-feather name="home"></i-feather>
                      <mat-label>Comune</mat-label>
                      <input matInput formControlName="city" type="text">
                    </mat-form-field>
                  </div>
                </div>

                <div class="row g-3"> 
                    <div class="col-sm-6 mt-10 text-start">
                      <button mat-flat-button matStepperPrevious class="mr-15 back">Indietro</button>
                    </div>
                    <div class="col-sm-6 mt-10 text-end">
                      <button type="button" mat-flat-button matStepperNext color="primary" [disabled]="disciplinaryForm.get('addressData')?.invalid">Avanti</button>
                    </div>
                </div>
           </mat-step>
            <mat-step>
              <ng-template matStepLabel>
                    Permessi
                </ng-template>
                <div class="row g-3 mt-20" [formGroupName]="'permissionsData'"> 
                    <label class="label d-block fw-medium mb-10">Permessi ai moduli</label>
                    <div 
                      class="permission-row"
                      *ngFor="let p of permissions; let i = index"
                      [class.odd]="i % 2 === 1"
                      (click)="togglePermission(p)">
                      
                      <span class="permission-name">{{ p.name }}</span>

                      <mat-checkbox
                        class="permission-checkbox"
                        [checked]="isPermissionChecked(p)"
                        (click)="$event.stopPropagation()"
                        (change)="onPermissionChange($event, p)">
                      </mat-checkbox>
                    </div>
                    <!-- Pulsanti -->
                    <div class="col-sm-6 mt-20 text-start">
                        <button mat-flat-button matStepperPrevious class="mr-15 back">Indietro</button>
                    </div>
                    <div class="col-sm-6 mt-20 text-end">
                        <button mat-flat-button color="primary" type="submit" [disabled]="disciplinaryForm.invalid">
                            Save
                        </button>
                    </div>
                  </div>
            </mat-step>
        </mat-stepper>
        <input formControlName="id" type="hidden" value="">
    </form>  
  </mat-card-content>
</mat-card>



